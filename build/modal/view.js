!function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t,s,o){return(s=function(t){var s=function(t){if("object"!=e(t)||!t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var o=s.call(t,"string");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(s)?s:s+""}(s))in t?Object.defineProperty(t,s,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[s]=o,t}class s{constructor({targetModal:e,modalElement:s,triggers:o=[],dismissedDuration:i,disableClosing:a=!1,portalContainerId:r,openTrigger:l="data-trigger-modal",closeTrigger:n="data-modal-close",openClass:d="is-open",bodyOpenClass:c="modal-is-open",focusFirstNode:h=!0,focusableElements:u='a[href],area[href],input:not([disabled]):not([type="hidden"]):not([aria-hidden]),select:not([disabled]):not([aria-hidden]),textarea:not([disabled]):not([aria-hidden]),button:not([disabled]):not([aria-hidden]),iframe,object,embed,[contenteditable],[tabindex]:not([tabindex^="-"])',storageKeyPrefix:g="pulsar_modal_",escKeyCode:m=27,tabKeyCode:p=9,modalSelector:y="data-modal-id",overlayClass:v="wp-block-pulsar-modal",overlayOverlayClass:b="wp-block-pulsar-modal__overlay"}){t(this,"modal",void 0),t(this,"modalId",void 0),t(this,"openTrigger",void 0),t(this,"closeTrigger",void 0),t(this,"closeTriggerType",void 0),t(this,"openClass",void 0),t(this,"bodyOpenClass",void 0),t(this,"dismissedDuration",0),t(this,"disableClosing",!1),t(this,"activeElement",void 0),t(this,"focusFirstNode",void 0),t(this,"focusableElements",void 0),t(this,"storageKeyPrefix",void 0),t(this,"escKeyCode",void 0),t(this,"tabKeyCode",void 0),t(this,"modalSelector",void 0),t(this,"overlayClass",void 0),t(this,"overlayOverlayClass",void 0),this.modalId=e,this.dismissedDuration=i,this.disableClosing=a,this.openTrigger=l,this.closeTrigger=n,this.openClass=d,this.bodyOpenClass=c,this.focusFirstNode=h,this.focusableElements=u,this.storageKeyPrefix=g,this.escKeyCode=m,this.tabKeyCode=p,this.modalSelector=y,this.overlayClass=v,this.overlayOverlayClass=b,this.closeTriggerType=n.startsWith("data-")?"data":"class",this.modal=s||document.querySelector(`[${this.modalSelector}="${this.modalId}"]`),this.modal&&(this.originalParent=this.modal.parentNode,this.portalContainer=document.getElementById(r),o.length>0&&this.registerTriggers(...o),this.onClick=this.onClick.bind(this),this.onKeydown=this.onKeydown.bind(this))}isCloseTrigger(e){return!!e&&("data"===this.closeTriggerType?e.hasAttribute(this.closeTrigger)||e.parentNode&&e.parentNode.hasAttribute(this.closeTrigger):e.classList.contains(this.closeTrigger)||e.parentNode&&e.parentNode.classList.contains(this.closeTrigger))}registerTriggers(...e){e.filter(Boolean).forEach((e=>{e.addEventListener("click",(e=>{("A"===e.target.tagName||e.target.closest("a"))&&!this.modal.classList.contains(this.openClass)&&(e.preventDefault(),e.stopPropagation()),this.showModal(!0)})),e.addEventListener("keydown",(e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),this.showModal(!0))}))}))}setStorage(){const e=(new Date).getTime()+60*this.dismissedDuration*1e3;window.localStorage.setItem(this.storageKeyPrefix+this.modalId,e)}getStorage(){const e=window.localStorage.getItem(this.storageKeyPrefix+this.modalId);return!!(e&&(new Date).getTime()<e)}showModal(e=!1){this.dismissedDuration&&this.getStorage()&&!1===e||(this.activeElement=this.modal.ownerDocument.activeElement,this.moveToPortal(),this.modal.classList.add(this.openClass),document.body.classList.add(this.bodyOpenClass),this.updateAriaExpanded("true"),this.addEventListeners(),this.focusFirstNode&&this.setFocusToFirstNode())}closeModal(){this.disableClosing||(this.removeEventListeners(),this.activeElement&&this.activeElement.focus&&this.activeElement.focus(),this.modal.classList.remove(this.openClass),document.body.classList.remove(this.bodyOpenClass),this.updateAriaExpanded("false"),this.restoreToOriginalParent(),this.dismissedDuration&&this.setStorage(),window.dispatchEvent(new CustomEvent("pulsar-modal-closed",{detail:this.modalId})))}moveToPortal(){this.portalContainer&&this.modal.parentNode!==this.portalContainer&&this.portalContainer.appendChild(this.modal)}restoreToOriginalParent(){this.originalParent&&this.modal.parentNode===this.portalContainer&&this.originalParent.appendChild(this.modal)}addEventListeners(){this.modal.addEventListener("touchstart",this.onClick),this.modal.addEventListener("click",this.onClick),document.addEventListener("keydown",this.onKeydown)}removeEventListeners(){this.modal.removeEventListener("touchstart",this.onClick),this.modal.removeEventListener("click",this.onClick),document.removeEventListener("keydown",this.onKeydown)}onClick(e){if(this.disableClosing){const t=this.isCloseTrigger(e.target),s=e.target.classList.contains(this.overlayClass)||e.target.classList.contains(this.overlayOverlayClass);if(t||s)return e.preventDefault(),void e.stopPropagation()}(this.isCloseTrigger(e.target)||e.target.classList.contains(this.overlayClass)||e.target.classList.contains(this.overlayOverlayClass))&&(e.preventDefault(),e.stopPropagation(),this.closeModal(e))}updateAriaExpanded(e){document.querySelectorAll(`[${this.openTrigger}="${this.modalId}"]`).forEach((t=>{t.setAttribute("aria-expanded",e)}))}onKeydown(e){this.disableClosing&&e.keyCode===this.escKeyCode?e.preventDefault():(e.keyCode===this.escKeyCode&&this.closeModal(e),e.keyCode===this.tabKeyCode&&this.retainFocus(e))}getFocusableNodes(){const e=this.modal.querySelectorAll(this.focusableElements);return Array.from(e)}setFocusToFirstNode(){const e=this.getFocusableNodes();if(0===e.length)return;const t=e.filter((e=>!this.isCloseTrigger(e)));t.length>0&&t[0].focus(),0===t.length&&e[0].focus()}setFocusToNode(e){e&&e.focus()}retainFocus(e){let t=this.getFocusableNodes();if(0===t.length)return;t=t.filter((e=>null!==e.offsetParent));const s=t.indexOf(this.modal.ownerDocument.activeElement);e.shiftKey&&0===s&&(t[t.length-1].focus(),e.preventDefault()),!e.shiftKey&&t.length>0&&s===t.length-1&&(t[0].focus(),e.preventDefault())}}window.pulsarBlocks=window.pulsarBlocks||{},window.pulsarBlocks.modals=new Map,window.addEventListener("DOMContentLoaded",(()=>{if(!document.getElementById("pulsar-modal-portal")){const e=document.createElement("div");e.id="pulsar-modal-portal",e.classList.add("pulsar-modal-portal"),document.body.appendChild(e)}window.modalBlocks=new Map,document.querySelectorAll(".wp-block-pulsar-modal").forEach((e=>{const t=e.getAttribute("data-modal-id"),o=e.getAttribute("data-modal-trigger-type"),i=e.getAttribute("data-modal-trigger-selector"),a=parseInt(e.getAttribute("data-modal-trigger-delay")),r=e.getAttribute("data-modal-dismissed-duration")||0,l="true"===e.getAttribute("data-modal-disable-closing"),n=r.toString().replace(/\d+/g,"");let d=r;if(n)switch(n){case"mins":d=parseInt(r);break;case"hrs":d=60*parseInt(r);break;case"days":d=1440*parseInt(r);break;default:console.warn(`Unknown dismissed unit: ${n}`)}const c=Object.assign({},{openTrigger:"data-trigger-modal",portalContainerId:"pulsar-modal-portal",closeTrigger:"data-modal-close"}),h=[...document.querySelectorAll(`[${c.openTrigger}="${t}"]`),..."click"===o&&i?document.querySelectorAll(`${i}`):[]];c.targetModal=t,c.triggers=h,c.dismissedDuration=d,c.disableClosing=l,window.pulsarBlocks.modals.set(t,new s(c));const u=window.pulsarBlocks.modals.get(t);if("load"!==o||null===a||isNaN(a)){if("scroll"===o&&i){const t=document.querySelector(i),s=parseInt(e.getAttribute("data-modal-scroll-threshold"))||10;t?new IntersectionObserver(((e,s)=>{e.forEach((e=>{e.isIntersecting&&(null===a||isNaN(a)?u.showModal():setTimeout((()=>u.showModal()),a),s.unobserve(t))}))}),{threshold:s/100}).observe(t):console.warn(`Pulsar Modal: Target element "${i}" not found for scroll trigger.`)}}else setTimeout((()=>u.showModal()),a)}))}))}();