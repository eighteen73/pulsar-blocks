(()=>{"use strict";class t{constructor(t){this.tablistNode=t,this.tabs=[],this.firstTab=null,this.lastTab=null,this.tabs=Array.from(this.tablistNode.querySelectorAll("[role=tab]")),this.tabpanels=[],this.deepLinking="true"===this.tablistNode.getAttribute("data-deep-linking"),this.deepLinkingUpdateHistory="true"===this.tablistNode.getAttribute("data-deep-linking-update-history"),this.selectNode=this.tablistNode.querySelector(".wp-block-pulsar-tabs__select");for(let t=0;t<this.tabs.length;t+=1){const e=this.tabs[t],s=document.getElementById(e.getAttribute("aria-controls"));this.tabpanels.push(s),e.addEventListener("keydown",this.onKeydown.bind(this)),e.addEventListener("click",this.onClick.bind(this)),this.firstTab||(this.firstTab=e),this.lastTab=e}this.selectNode&&this.selectNode.addEventListener("change",this.onSelectChange.bind(this)),this.deepLinking&&this.initializeDeepLinking()}setSelectedTab(t,e){"boolean"!=typeof e&&(e=!0);let s=null;for(let i=0;i<this.tabs.length;i+=1){const a=this.tabs[i];if(t===a){a.setAttribute("aria-selected","true"),a.removeAttribute("tabindex"),this.tabpanels[i].removeAttribute("hidden");const t=a.id.match(/-tab-(\d+)$/);t&&(s=t[1]),e&&a.focus(),this.updateUrlHash(a)}else a.setAttribute("aria-selected","false"),a.tabIndex=-1,this.tabpanels[i].setAttribute("hidden",!0)}this.selectNode&&s&&(this.selectNode.value=s)}setSelectedToPreviousTab(t){let e;t===this.firstTab?this.setSelectedTab(this.lastTab):(e=this.tabs.indexOf(t),this.setSelectedTab(this.tabs[e-1]))}setSelectedToNextTab(t){let e;t===this.lastTab?this.setSelectedTab(this.firstTab):(e=this.tabs.indexOf(t),this.setSelectedTab(this.tabs[e+1]))}getTabByNumber(t){return this.tabs.find((e=>{const s=e.id.match(/-tab-(\d+)$/);return s&&s[1]===String(t)}))}onSelectChange(t){const e=t.target.value,s=this.getTabByNumber(e);s&&this.setSelectedTab(s,!1)}onKeydown(t){const e=t.currentTarget;let s=!1;switch(t.key){case"ArrowLeft":this.setSelectedToPreviousTab(e),s=!0;break;case"ArrowRight":this.setSelectedToNextTab(e),s=!0;break;case"Home":this.setSelectedTab(this.firstTab),s=!0;break;case"End":this.setSelectedTab(this.lastTab),s=!0}s&&(t.stopPropagation(),t.preventDefault())}getCurrentTabIndex(){const t=this.tabs;for(let e=0;e<t.length;e++)if("true"===t[e].getAttribute("aria-selected"))return e;return-1}goTo(t){const e=this.tabs;t>0&&t<=e.length?this.setSelectedTab(e[t-1]):console.error("Invalid tab index")}onClick(t){this.setSelectedTab(t.currentTarget)}initializeDeepLinking(){this.checkHashOnLoad(),window.addEventListener("hashchange",this.onHashChange.bind(this))}checkHashOnLoad(){const t=window.location.hash;t&&this.activateTabByHash(t)}onHashChange(){const t=window.location.hash;t&&this.activateTabByHash(t)}activateTabByHash(t){const e=t.substring(1);let s=null,i=-1;for(let t=0;t<this.tabpanels.length;t+=1){const a=this.tabpanels[t];if(a.getAttribute("data-deep-linking-id")===e){s=a,i=t;break}}s&&-1!==i&&this.tabs[i]&&(this.setSelectedTab(this.tabs[i],!1),this.scrollTabIntoView(this.tabs[i]))}scrollTabIntoView(t){setTimeout((()=>{t.scrollIntoView({behavior:"smooth",block:"start"})}),100)}updateUrlHash(t){if(!this.deepLinking)return;const e=t.getAttribute("aria-controls"),s=document.getElementById(e);if(!s)return;const i=s.getAttribute("data-deep-linking-id");if(!i)return;const a=`#${i}`;this.deepLinkingUpdateHistory?window.history.pushState(null,null,a):window.history.replaceState(null,null,a)}}window.pulsarBlocks=window.pulsarBlocks||{},window.pulsarBlocks.tabs=new Map,window.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".wp-block-pulsar-tabs").forEach((e=>{const s=e.getAttribute("data-tabs-id");window.pulsarBlocks.tabs.set(s,new t(e))}))}))})();